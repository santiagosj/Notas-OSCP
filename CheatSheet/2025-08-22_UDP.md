### üß™ Clase: Escaneo y An√°lisis de UDP

#### 1. Introducci√≥n

Cuando pensamos en escaneo de puertos, solemos enfocarnos en TCP (por su fiabilidad y estado de conexi√≥n).
Pero UDP (User Datagram Protocol) tambi√©n es muy usado y cr√≠tico, especialmente para servicios de DNS, SNMP, NTP, TFTP, RADIUS, VoIP, etc.

> üëâ Lo complicado de UDP es que no hay handshake ni confirmaci√≥n como en TCP.

* Esto hace que:

- Los escaneos UDP sean m√°s lentos.

- Las respuestas sean ambiguas (muchos puertos ‚Äúparecen cerrados‚Äù porque simplemente no responden).

- Los firewalls los filtren mucho m√°s.

2. Servicios comunes en UDP

Algunos puertos UDP que suelen interesar en pruebas de seguridad:

| Puerto    | Servicio  | Riesgo t√≠pico                         |
| --------- | --------- | ------------------------------------- |
| 53        | DNS       | Zone transfer, amplification attacks  |
| 67/68     | DHCP      | Rogue servers, info leakage           |
| 69        | TFTP      | Transferencia sin autenticaci√≥n       |
| 123       | NTP       | Amplificaci√≥n DDoS, clock tampering   |
| 137-139   | NetBIOS   | Enumeraci√≥n, info sobre hosts Windows |
| 161/162   | SNMP      | Community strings por defecto         |
| 500       | IKE       | VPNs vulnerables                      |
| 514       | Syslog    | Recolecci√≥n de logs inseguros         |
| 1812/1813 | RADIUS    | Cracking de credenciales              |
| 1900      | SSDP/UPnP | Exposici√≥n de dispositivos IoT        |

#### 3. Comandos

* **nmap**

1. **SNMP**

```bash
nmap -sU -p 161 -sV -sC <target_ip>
```

2. Puertos

```bash
nmap -sU -p 53,67,69,123,137,161,500,514,1812,1900 <IP> -v
```

3. UDP ping

```bash
nmap -sU -PE <IP>
```
4. top-ports:
```bash
nmap -sU --top-ports 50 <IP>
```

* **snmpwalk**

1. 
```bash
snmpwalk -c public -v1 -t 10 <target_ip>
```
2. Usuarios de Windows
```bash
snmpwalk -c public -v1 <target_ip> 1.3.6.1.4.1.77.1.2.25
```
3. Procesos
```bash
snmpwalk -c public -v1 <target_ip> 1.3.6.1.2.1.25.4.2.1.2
```
4. Software instalado
```bash
snmpwalk -c public -v1 <target_ip> 1.3.6.1.2.1.25.6.3.1.2
```
5. Puertos
```bash
snmpwalk -c public -v1 <target_ip> 1.3.6.1.2.1.6.13.1.3
```
