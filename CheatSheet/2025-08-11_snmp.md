# SNMP Pentesting Cheatsheet

## Qué es SNMP
- SNMP (Simple Network Management Protocol) permite monitorear y administrar dispositivos de red (routers, switches, impresoras, servidores, etc.).
- Usa UDP/161 y funciona con "comunidades" (parecido a contraseñas).
- Comunidades comunes:
  - public → lectura (read-only)
  - private → escritura (read-write)
  - manager → administración

## Qué es un OID
- OID (Object Identifier) = identificador numérico que apunta a un objeto/valor en la base SNMP.
- Es jerárquico como un árbol.
- Ejemplos:
  - 1.3.6.1.2.1.1 → Información general
  - 1.3.6.1.2.1.25.4.2.1.2 → Procesos activos
  - 1.3.6.1.4.1.77.1.2.25 → Usuarios

## Comandos útiles

### 1. Enumerar con snmpwalk
snmpwalk -v2c -c public <IP>
snmpwalk -v1 -c public <IP>
snmpwalk -v2c -c public <IP> 1.3.6.1.2.1.1         # Info del sistema
snmpwalk -v2c -c public <IP> 1.3.6.1.4.1.77.1.2.25 # Usuarios
snmpwalk -v2c -c public <IP> 1.3.6.1.4.1.77.1.2.3  # Recursos compartidos
snmpwalk -v2c -c public <IP> 1.3.6.1.2.1.25.4.2.1.2 # Procesos

### 2. Enumerar con snmp-check (más legible)
snmp-check <IP> -c public

### 3. Fuerza bruta de comunidades con onesixtyone
onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp.txt <IP>

### 4. OIDs más útiles en Windows
1.3.6.1.2.1.1              → Información general
1.3.6.1.4.1.77.1.2.25      → Usuarios
1.3.6.1.4.1.77.1.2.3       → Recursos compartidos
1.3.6.1.2.1.25.4.2.1.2     → Procesos
1.3.6.1.2.1.25.6.3.1.2     → Software instalado
1.3.6.1.2.1.4.20.1.1       → IPs configuradas

### 5. Guardar resultados
snmpwalk -v2c -c public <IP> > snmp_loot.txt

## Nota de pentesting
- SNMP mal configurado en Windows puede revelar usuarios, hostnames y recursos compartidos para pivotar a SMB, RDP o WinRM.
